TEMPLATE_HTML = "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"/>\n  <title>{{ company }} Snapshot Report - {{ domain }} ({{ tier }})</title>\n  <style>\n    body { font-family: Arial, sans-serif; margin: 24px; }\n    h1 { font-size: 28px; margin-bottom: 0; }\n    h2 { margin-top: 28px; }\n    .pill { padding: 2px 8px; border-radius: 12px; background: #efefef; display: inline-block; }\n    pre { background: #f7f7f7; padding: 12px; overflow-x: auto; }\n    table { border-collapse: collapse; width: 100%; }\n    th, td { border: 1px solid #ddd; padding: 8px; font-size: 12px; }\n    th { background: #fafafa; }\n    .sev-info { color: #555; }\n    .sev-low { color: #4a7; }\n    .sev-medium { color: #c80; }\n    .sev-high { color: #e55; }\n    .sev-critical { color: #b00; font-weight: bold; }\n  </style>\n</head>\n<body>\n  <h1>{{ company }} - Snapshot Report</h1>\n  <div class=\"pill\">{{ tier|upper }}</div>\n  <p><strong>Client:</strong> {{ domain }}<br/>\n     <strong>Generated:</strong> {{ generated }}</p>\n\n  <h2>Executive Summary</h2>\n  <p>This Snapshot provides a quick view into exposed services, TLS health, security headers, and threat intel context.</p>\n\n  <h2>Key Findings</h2>\n  <ul>\n    {% for f in key_findings %}\n      <li class=\"sev-{{ f.severity }}\">{{ f.title }}</li>\n    {% endfor %}\n  </ul>\n\n  <h2>Assets</h2>\n  <table>\n    <tr><th>Hostname</th><th>IPs</th></tr>\n    {% for host, ips in hosts.items() %}\n      <tr><td>{{ host }}</td><td>{{ ips }}</td></tr>\n    {% endfor %}\n  </table>\n\n  <h2>Nmap Summary</h2>\n  <pre>{{ nmap_summary }}</pre>\n\n  <h2>Shodan</h2>\n  <pre>{{ shodan_json }}</pre>\n\n  <h2>SSL Labs</h2>\n  <pre>{{ ssllabs_json }}</pre>\n\n  <h2>Mozilla Observatory</h2>\n  <pre>{{ moz_json }}</pre>\n\n  <h2>Threat Intel</h2>\n  <pre>{{ intel_json }}</pre>\n\n  <hr/>\n  <p>\u00a9 {{ year }} {{ company }}</p>\n</body>\n</html>"